<%- include('layouts/main', { title: 'Analytics' , activePage: 'analytics' , head: ` <script
    src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    `,
    body: ` <div class="content-area">
        <!-- Page Header -->
        <div class="section-header">
            <div>
                <h1 class="page-title">Analytics</h1>
                <p class="page-subtitle">Flight performance and operational insights</p>
            </div>
            <div class="flex gap-sm">
                <select class="form-select" id="dateRange" style="width: auto;">
                    <option value="today">Today</option>
                    <option value="week" selected>Last 7 Days</option>
                    <option value="month">Last 30 Days</option>
                </select>
                <button class="btn btn-ghost" onclick="exportReport()">Export Report</button>
            </div>
        </div>

        <!-- Key Metrics -->
        <div class="stats-grid mb-lg" style="grid-template-columns: repeat(5, 1fr);">
            <div class="stat-card">
                <div class="stat-value" id="totalFlights">--</div>
                <div class="stat-label">Total Flights</div>
            </div>
            <div class="stat-card highlight-green">
                <div class="stat-value" id="successRate">--</div>
                <div class="stat-label">Success Rate</div>
            </div>
            <div class="stat-card highlight-blue">
                <div class="stat-value" id="totalDistance">--</div>
                <div class="stat-label">Distance Flown</div>
            </div>
            <div class="stat-card highlight-yellow">
                <div class="stat-value" id="totalFlightTime">--</div>
                <div class="stat-label">Flight Time</div>
            </div>
            <div class="stat-card highlight-red">
                <div class="stat-value" id="conflictsResolved">--</div>
                <div class="stat-label">Active Conflicts</div>
            </div>
        </div>

        <div class="grid-2-col mb-lg">
            <!-- Flight Activity Chart -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Flight Activity</div>
                </div>
                <div class="card-body" style="height: 300px;">
                    <canvas id="flightActivityChart"></canvas>
                </div>
            </div>

            <!-- Conflict Analysis -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Conflict Analysis</div>
                </div>
                <div class="card-body" style="height: 300px;">
                    <canvas id="conflictChart"></canvas>
                </div>
            </div>
        </div>

        <div class="grid-2-col mb-lg">
            <!-- Flight Duration Distribution -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Flight Duration Distribution</div>
                </div>
                <div class="card-body" style="height: 280px;">
                    <canvas id="durationChart"></canvas>
                </div>
            </div>

            <!-- Hourly Activity -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Hourly Flight Activity</div>
                </div>
                <div class="card-body" style="height: 280px;">
                    <canvas id="hourlyChart"></canvas>
                </div>
            </div>
        </div>

        <div class="grid-2-col">
            <!-- Fleet Performance -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Fleet Performance</div>
                </div>
                <div class="card-body">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Drone</th>
                                <th>Flights</th>
                                <th>Distance</th>
                                <th>Uptime</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="fleetTable">
                            <tr>
                                <td colspan="5" class="text-muted">Loading fleet metrics...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Recent Events Log -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Event Log</div>
                </div>
                <div class="card-body" id="eventLog" style="max-height: 300px; overflow-y: auto;">
                    <div class="empty-state" style="padding: 24px;">
                        <div class="empty-state-text text-muted">Loading events...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    `,
    scripts: `
    <script src="/assets/js/analytics.js"></script>
    `
    }) %>
